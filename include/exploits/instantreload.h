#pragma once
#include <exploit.h>
#include <ue4.h>
#include <config.h>
#include <cache.h>

class InstantReload : public Exploit<AItem_Gun_General*, ReloadAnimations> {
public:
	InstantReload() : Exploit<AItem_Gun_General*, ReloadAnimations>("Instant Reload") {};

	void* get_object_ptr() override {
		return cache::LocalCurrentWeapon;
	}

	ReloadAnimations get_write_data() override {
		return { nullptr };
	}

	bool* get_enabled_ptr() override {
		return &config::config->data()->instant_reload;
	}

	void write(AItem_Gun_General* object, ReloadAnimations data) override {
		object->set_reload_animations(data.ReloadCharacterAnimation, data.ReloadFullCharacterAnimation, data.ReloadGunAnimation, data.ReloadFullGunAnimation);
	}

	void read_data(ReloadAnimations* buffer) override {
		*buffer = cache::LocalCurrentWeapon->get_reload_animations();
	}
};